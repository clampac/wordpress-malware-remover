# WordPress Maintenance

This project provides scripts to automate maintenance tasks for multiple WordPress sites hosted on the same server.

## Directory Structure

- `your-installation-directory/`
  - `wordpress/` (directory where you copy the new installation of WordPress)
  - `logs/` (directory where logs are stored)
  - `downloads/` (directory where WordPress versions are downloaded)
  - `backups/` (directory where backups are stored)
  - `fix_permissions.py` (fixes permissions of files and directories)
  - `manage_database.py` (manages database users and permissions)
  - `replace_wordpress.py` (replaces WordPress directories)
  - `update_wordpress.py` (updates WordPress to a specified version)
  - `backup.py` (performs backups of databases and files)
  - `utils.py` (utility functions, such as password generation, logging, etc.)
  - `main.py` (main script to orchestrate the execution of other scripts)
  - `requirements.txt` (Python dependencies)
  - `config.ini` (configuration file)
  - `README.md` (this file)
  - `.gitignore` (files and directories to be ignored by Git)

## Installation

1. Create the necessary directory structure:
   ```bash
   sudo mkdir -p your-installation-directory/{wordpress,logs,downloads,backups}
   ```

2. Copy the project files to `your-installation-directory/`.

3. Install Python dependencies:
   ```bash
   sudo apt-get update
   sudo apt-get install python3-pip -y
   sudo pip3 install -r your-installation-directory/requirements.txt
   ```

4. Create a shell script to run the main Python script from any directory:
   ```bash
   sudo touch /usr/local/bin/wordpress-maintenance.sh
   sudo chmod +x /usr/local/bin/wordpress-maintenance.sh
   echo #!/bin/bash
   python3 your-installation-directory/main.py "$@" | sudo tee /usr/local/bin/wordpress-maintenance.sh
   ```

## Usage

To run the maintenance scripts, use the following command:
```bash
wordpress-maintenance.sh
```

### Flags

- `--update-wordpress`: Lists the latest 5 versions of WordPress available for download. Allows the user to choose a version and a language to download. Downloads and installs the chosen version in the `wordpress/` directory.
- `-a`: Executes the maintenance procedure for all sites.

### Direct Execution

To execute the `main.py` script directly and pass the `--update-wordpress` flag:
```bash
python3 your-installation-directory/main.py --update-wordpress
```

To execute the `main.py` script directly and pass the `-a` flag:
```bash
python3 your-installation-directory/main.py -a
```

## Scripts Overview

- `fix_permissions.py`: Fixes permissions for files and directories in the `htdocs` directory.
- `manage_database.py`: Manages database users, updates `wp-config.php` with new credentials.
- `replace_wordpress.py`: Replaces the `wp-includes` and `wp-admin` directories with the new version.
- `update_wordpress.py`: Updates WordPress to a specified version.
- `backup.py`: Creates backups of the `htdocs` directory and the database, and logs installed plugins and themes.
- `utils.py`: Contains utility functions for password generation, logging, running commands, and listing plugins and themes.
- `main.py`: Orchestrates the execution of the other scripts.

## Future Improvements

- Add continuous monitoring functionality.
- Integrate with GitHub for version control and collaboration.
