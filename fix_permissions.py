import os
import utils

def fix_permissions(wp_install_dir):
    """Fix permissions for files and directories in the WordPress installation."""
    utils.log_action("Fixing permissions for files and directories.")

    # Set permissions for directories
    for root, dirs, files in os.walk(wp_install_dir):
        for dir_name in dirs:
            dir_path = os.path.join(root, dir_name)
            os.chmod(dir_path, 0o755)
            utils.log_action(f"Set 755 permissions for directory: {dir_path}")

    # Set permissions for files
    for root, dirs, files in os.walk(wp_install_dir):
        for file_name in files:
            file_path = os.path.join(root, file_name)
            os.chmod(file_path, 0o644)
            utils.log_action(f"Set 644 permissions for file: {file_path}")

if __name__ == "__main__":
    import sys
    wp_install_dir = sys.argv[1]
    fix_permissions(wp_install_dir)
