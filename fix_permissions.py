import os
import secrets
import logging
import requests

def generate_secure_password(length=16):
    """Generate a secure password using the secrets library."""
    return secrets.token_urlsafe(length)

def setup_logging(site_name):
    """Setup logging for a given site."""
    log_file = f"/opt/wordpress-maintenance/logs/{site_name}.log"
    logging.basicConfig(filename=log_file, level=logging.INFO,
                        format='%(asctime)s %(message)s')
    logging.info("\n\n" + "-"*80 + "\n\n")

def log_action(site_name, message):
    """Log an action for a given site."""
    logging.info(message)

def run_command(command):
    """Run a system command and log the output."""
    result = os.system(command)
    logging.info(f"Command: {command}\nResult: {result}")

def get_root_password():
    """Prompt the user for the root password of the database."""
    import getpass
    return getpass.getpass("Enter root password for the database: ")

def get_latest_wordpress_versions(count=5):
    """Get the latest WordPress versions."""
    response = requests.get("https://api.wordpress.org/core/version-check/1.7/")
    versions = response.json()['offers']
    return [v['version'] for v in versions[:count]]

def download_wordpress_version(version, download_path):
    """Download the specified WordPress version."""
    url = f"https://wordpress.org/wordpress-{version}.tar.gz"
    response = requests.get(url)
    with open(download_path, 'wb') as file:
        file.write(response.content)
